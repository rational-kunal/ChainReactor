(this.webpackJsonpchainreactor=this.webpackJsonpchainreactor||[]).push([[0],[,,,,,,,,function(e,t,n){},,function(e,t,n){e.exports=n(17)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(9),o=n.n(a),l=(n(15),n(16),n(1)),s=n(2),u=n(3),c=n(5),h=n(4),d=n(6),p=(n(8),function(){function e(t){var n=t.value,r=t.player,i=t.coordinate,a=t.onTap;Object(l.a)(this,e),this.props={value:n,player:r,coordinate:i,onTap:a},this.state={animationState:y(0,null),nextAnimationState:y(0,null)}}return Object(s.a)(e,[{key:"valueChanged",value:function(e){var t=e.value,n=e.player,r=e.delay;this.state={animationState:this.state.nextAnimationState,nextAnimationState:y(t,n),delay:r},this.props.value=t}},{key:"render",value:function(){return i.a.createElement("div",{className:"game-node"},i.a.createElement(v,{coordinate:this.props.coordinate,value:this.props.value,onTap:this.props.onTap,animationState:this.state.animationState,nextAnimationState:this.state.nextAnimationState,delay:this.state.delay}))}}]),e}());function y(e,t){return{transform:"scale("+(1+e/4)+")",backgroundColor:null==t?"#30475e":["#3282b8","#c02739"][t]}}function v(e){var t=e.coordinate,n=e.onTap,r=e.value,a=e.animationState,o=e.nextAnimationState,l=e.delay,s=Object(d.c)({to:o,from:a,delay:l,config:d.b.wobbly});return i.a.createElement(d.a.div,{style:s,className:"inner-node",onClick:function(){return n(t)}},r)}var f=function(){function e(t,n){Object(l.a)(this,e),this.playerSize=t,this.currentPlayer=0,this.wonFn=n,this.wait=!1,this.defeatedPool=Array(this.playerSize).fill(!1),this.playerNRegion=Array(this.playerSize).fill(0),this.moves=0}return Object(s.a)(e,[{key:"moveComplete",value:function(){for(this.moves++,this.currentPlayer++,this.currentPlayer%=this.playerSize;this.defeatedPool[this.currentPlayer];)this.currentPlayer++,this.currentPlayer%=this.playerSize}},{key:"isComplete",value:function(){var e=this,t=0;return this.moves>this.playerSize&&!this.wait&&(this.playerNRegion.forEach((function(e,n){return e>0||t++})),1===t&&(this.playerNRegion.forEach((function(t,n){return t>0||e.wonFn(n)})),!0))}}]),e}(),m=function(){function e(t,n,r){Object(l.a)(this,e),this.grid=[],this.gridSize=t,this.playerController=new f(n,r);for(var i=0;i<this.gridSize.row;i++){this.grid.push([]);for(var a=0;a<this.gridSize.column;a++)this.grid[i].push({value:0,player:null})}}return Object(s.a)(e,[{key:"printGrid",value:function(){for(var e=0;e<this.gridSize.row;e++)console.log(this.grid[e])}},{key:"canAddAt",value:function(e,t){return null==this.grid[e][t].player||this.grid[e][t].player===this.playerController.currentPlayer}},{key:"canExplode",value:function(e,t){var n=this.grid[e][t].value;return 0===e&&0===t||0===e&&t===this.gridSize.column-1||e===this.gridSize.row-1&&0===t||e===this.gridSize.row-1&&t===this.gridSize.column-1?1===n:0===e||e===this.gridSize.row-1||0===t||t===this.gridSize.column-1?2===n:3===n}},{key:"explosionIn",value:function(e,t){var n=this;return[{x:e-1,y:t},{x:e+1,y:t},{x:e,y:t-1},{x:e,y:t+1}].filter((function(e){var t=e.x,r=e.y;return t>=0&&t<n.gridSize.row&&r>=0&&r<n.gridSize.column}))}},{key:"reactionAt",value:function(e,t,n){var r={change:{value:0,player:null},explodeTo:[]};this.canExplode(e,t)?(r.explodeTo=this.explosionIn(e,t),this.grid[e][t].value=0,this.playerController.playerNRegion[this.grid[e][t].player]--,this.playerController.wait=!0,this.grid[e][t].player=null):(this.grid[e][t].value++,this.playerController.playerNRegion[this.grid[e][t].player]--,this.playerController.wait=!1,this.grid[e][t].player=this.playerController.currentPlayer,r.change.player=this.playerController.currentPlayer,this.playerController.playerNRegion[this.grid[e][t].player]++),r.change.value=this.grid[e][t].value,n(r)}},{key:"didMove",value:function(e,t){var n=this;if(!this.canAddAt(e,t))return null;for(var r=[{x:e,y:t}],i=[],a=function(){var e=[],t={valueChangeAt:[],explosions:[]};r.forEach((function(r,i){var a=r.x,o=r.y;n.playerController.isComplete()||n.reactionAt(a,o,(function(n){var r=n.change,i=n.explodeTo;t.valueChangeAt.push({x:a,y:o,value:r.value,player:r.player}),i.forEach((function(n){t.explosions.push({ux:a,uy:o,vx:n.x,vy:n.y}),e.push(n)}))}))})),i.push(t),r=e};0!==r.length&&!this.playerController.isComplete();)a();return this.playerController.moveComplete(),i}}]),e}(),g=function(e){Object(c.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).nodeGrid=[],r.wait=!1,r.gridSize=e.gridSize,r.state={won:!1},r.gameController=new m({row:r.gridSize.rowCount,column:r.gridSize.columnCount},e.playerCount,(function(e){r.setState({won:e+1})})),r.nodeTapped=r.nodeTapped.bind(Object(u.a)(r)),r}return Object(s.a)(n,[{key:"nodeTapped",value:function(e){var t=this,n=e.row,r=e.column;if(!this.wait){var i=this.gameController.didMove(n,r);if(null!=i){var a=0;i.forEach((function(e){e.valueChangeAt.forEach((function(e){var n=e.x,r=e.y,i=e.value,o=e.player;t.nodeGrid[n][r].valueChanged({value:i,player:o,delay:a})})),a+=300})),this.wait=!0,setTimeout((function(){t.wait=!1,t.forceUpdate()}),a-300),this.forceUpdate()}}}},{key:"componentDidMount",value:function(){for(var e=0;e<this.gridSize.rowCount;e++){this.nodeGrid.push([]);for(var t=0;t<this.gridSize.columnCount;t++)this.nodeGrid[e].push(new p({value:0,player:null,coordinate:{row:e,column:t},onTap:this.nodeTapped}))}this.forceUpdate()}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:10*this.gridSize.columnCount+"vmin",display:"flex",flexWrap:"wrap"},className:"board"},i.a.createElement("div",{style:{width:10*this.gridSize.columnCount+"vmin"},className:"helper"},this.state.won?this.state.won+" has won":(!this.wait||"wait for animation, ")+this.gameController.playerController.currentPlayer+"'s turn"),this.nodeGrid.flat(2).map((function(e){return e.render()})))}}]),n}(i.a.Component);var w=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(g,{classList:"center",gridSize:{rowCount:6,columnCount:4},playerCount:2}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.b565ba53.chunk.js.map